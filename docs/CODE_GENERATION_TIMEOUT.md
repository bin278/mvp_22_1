# ä»£ç ç”Ÿæˆæ—¶é—´é™åˆ¶è¯´æ˜

## ğŸ“Š å½“å‰é…ç½®æ¦‚è§ˆ

### æµå¼ç”Ÿæˆæ¨¡å¼ï¼ˆStreamingï¼‰

**è¶…æ—¶æ£€æµ‹æœºåˆ¶ï¼š**
- â±ï¸ **30ç§’æ— å“åº”**ï¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼
- â±ï¸ **15ç§’æ— å†…å®¹**ï¼šå¦‚æœå†…å®¹å°‘äº50å­—ç¬¦ï¼Œåˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼
- â±ï¸ **10ç§’è¿›åº¦åœæ»**ï¼šå¦‚æœè¿›åº¦å°äº20%ï¼Œåˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼

**å¿ƒè·³æœºåˆ¶ï¼š**
- ğŸ’“ æ¯10ç§’å‘é€ä¸€æ¬¡å¿ƒè·³ä¿¡å·ï¼Œä¿æŒè¿æ¥æ´»è·ƒ
- ğŸ”„ é˜²æ­¢ä»£ç†/è´Ÿè½½å‡è¡¡å™¨ä¸­æ–­è¿æ¥

**å®é™…å¯ç”¨æ—¶é—´ï¼š**
- âœ… **ç®€å•ä»»åŠ¡**ï¼šé€šå¸¸30ç§’å†…å®Œæˆï¼Œæµå¼æ˜¾ç¤º
- âœ… **ä¸­ç­‰ä»»åŠ¡**ï¼š30ç§’-5åˆ†é’Ÿï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼
- âœ… **å¤æ‚ä»»åŠ¡**ï¼šç›´æ¥ä½¿ç”¨å¼‚æ­¥æ¨¡å¼ï¼Œä¸å—æµå¼è¶…æ—¶é™åˆ¶

### å¼‚æ­¥ç”Ÿæˆæ¨¡å¼ï¼ˆAsync Fallbackï¼‰

**è¶…æ—¶é™åˆ¶ï¼š**
- â±ï¸ **CloudBaseè¶…æ—¶**ï¼š300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰- éœ€è¦åœ¨æ§åˆ¶å°é…ç½®
- â±ï¸ **AI APIè¶…æ—¶**ï¼šå–å†³äºAIæœåŠ¡æä¾›å•†çš„é™åˆ¶
  - DeepSeek: é€šå¸¸æ”¯æŒé•¿æ—¶é—´ç”Ÿæˆ
  - GLM-4.6: é€šå¸¸æ”¯æŒé•¿æ—¶é—´ç”Ÿæˆ

**å®é™…å¯ç”¨æ—¶é—´ï¼š**
- âœ… **ç†è®ºä¸Š**ï¼šæœ€å¤š5åˆ†é’Ÿï¼ˆå—CloudBaseè¶…æ—¶é™åˆ¶ï¼‰
- âœ… **å®é™…**ï¼šå–å†³äºAIæ¨¡å‹çš„å¤„ç†èƒ½åŠ›å’Œå“åº”é€Ÿåº¦

## ğŸ¯ ä¸åŒåœºæ™¯çš„æ—¶é—´é™åˆ¶

### åœºæ™¯1ï¼šç®€å•ä»£ç ç”Ÿæˆ
```
ç”¨æˆ·è¾“å…¥: "åˆ›å»ºä¸€ä¸ªç®€å•çš„ç™»å½•é¡µé¢"
é¢„è®¡æ—¶é—´: 10-30ç§’
æ¨¡å¼: æµå¼ç”Ÿæˆ
çŠ¶æ€: âœ… å®æ—¶æ˜¾ç¤ºï¼Œæ‰“å­—æœºæ•ˆæœ
```

### åœºæ™¯2ï¼šä¸­ç­‰å¤æ‚åº¦ä»£ç ç”Ÿæˆ
```
ç”¨æˆ·è¾“å…¥: "åˆ›å»ºä¸€ä¸ªåŒ…å«å›¾è¡¨çš„æ•°æ®çœ‹æ¿"
é¢„è®¡æ—¶é—´: 30ç§’-2åˆ†é’Ÿ
æ¨¡å¼: æµå¼ â†’ å¼‚æ­¥åˆ‡æ¢
çŠ¶æ€: âœ… å¼€å§‹æµå¼ï¼Œè‡ªåŠ¨åˆ‡æ¢å¼‚æ­¥
```

### åœºæ™¯3ï¼šå¤æ‚ä»£ç ç”Ÿæˆ
```
ç”¨æˆ·è¾“å…¥: "åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç”µå•†å¹³å°ï¼ŒåŒ…å«å•†å“åˆ—è¡¨ã€è´­ç‰©è½¦ã€æ”¯ä»˜..."
é¢„è®¡æ—¶é—´: 2-5åˆ†é’Ÿ
æ¨¡å¼: å¼‚æ­¥ç”Ÿæˆï¼ˆç›´æ¥ï¼‰
çŠ¶æ€: âœ… æ˜¾ç¤ºè¿›åº¦æ¡ï¼Œå®Œæˆåæ˜¾ç¤ºç»“æœ
```

## âš™ï¸ é…ç½®è¯´æ˜

### CloudBaseè¶…æ—¶é…ç½®ï¼ˆå…³é”®ï¼ï¼‰

**å½“å‰æ¨èè®¾ç½®ï¼š**
- â±ï¸ **è¶…æ—¶æ—¶é—´**ï¼š300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰
- ğŸ“ **é…ç½®ä½ç½®**ï¼šCloudBaseæ§åˆ¶å° â†’ äº‘æ‰˜ç®¡ â†’ è®¾ç½® â†’ è¶…æ—¶æ—¶é—´

**å¦‚ä½•é…ç½®ï¼š**
1. ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°ï¼šhttps://console.cloud.tencent.com/tcb/
2. è¿›å…¥äº‘æ‰˜ç®¡é¡µé¢
3. é€‰æ‹©ä½ çš„åº”ç”¨
4. ç‚¹å‡»"è®¾ç½®"æ ‡ç­¾é¡µ
5. æ‰¾åˆ°"è¶…æ—¶æ—¶é—´"è®¾ç½®
6. è®¾ç½®ä¸ºï¼š**300ç§’**
7. ä¿å­˜å¹¶é‡æ–°éƒ¨ç½²

### ä»£ç å±‚é¢çš„è¶…æ—¶è®¾ç½®

**æµå¼ç”Ÿæˆè¶…æ—¶æ£€æµ‹ï¼š**
```typescript
// app/api/generate-stream/route.ts
function shouldFallback(state: GenerationState): boolean {
  const timeElapsed = Date.now() - state.lastActivity
  
  // 30ç§’æ— å“åº”
  if (timeElapsed > 30000) return true
  
  // 15ç§’æ— å†…å®¹
  if (timeElapsed > 15000 && state.streamedContent.length < 50) return true
  
  // 10ç§’è¿›åº¦åœæ»
  if (timeElapsed > 10000 && state.progress < 20) return true
  
  return false
}
```

**å¿ƒè·³é—´éš”ï¼š**
```typescript
// æ¯10ç§’å‘é€å¿ƒè·³
const heartbeatInterval = setInterval(() => {
  safeEnqueue(`data: ${JSON.stringify({ type: 'heartbeat' })}\n\n`)
}, 10000)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å·²å®ç°çš„ä¼˜åŒ–

1. **æ™ºèƒ½æ¨¡å¼åˆ‡æ¢**
   - è‡ªåŠ¨æ£€æµ‹ä»»åŠ¡å¤æ‚åº¦
   - é«˜é£é™©ä»»åŠ¡ç›´æ¥ä½¿ç”¨å¼‚æ­¥æ¨¡å¼
   - æµå¼ç”Ÿæˆå¤±è´¥è‡ªåŠ¨åˆ‡æ¢åˆ°å¼‚æ­¥

2. **å¿ƒè·³æœºåˆ¶**
   - æ¯10ç§’å‘é€å¿ƒè·³
   - ä¿æŒè¿æ¥æ´»è·ƒ
   - é˜²æ­¢ä»£ç†è¶…æ—¶

3. **æ‰¹é‡å­—ç¬¦å‘é€**
   - æ¯5ä¸ªå­—ç¬¦æ‰¹é‡å‘é€
   - å‡å°‘ç½‘ç»œå¼€é”€
   - æé«˜å“åº”é€Ÿåº¦

4. **è¿æ¥æ£€æµ‹å’Œé‡è¯•**
   - å‰ç«¯æ£€æµ‹è¿æ¥åœæ»
   - è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼ˆæœ€å¤š3æ¬¡ï¼‰
   - 30ç§’æ— æ•°æ®è‡ªåŠ¨é‡è¿

### å»ºè®®çš„è¿›ä¸€æ­¥ä¼˜åŒ–

1. **å¢åŠ CloudBaseè¶…æ—¶æ—¶é—´**
   - å¦‚æœç»å¸¸éœ€è¦ç”Ÿæˆå¤æ‚ä»£ç ï¼Œå¯ä»¥å¢åŠ åˆ°600ç§’ï¼ˆ10åˆ†é’Ÿï¼‰
   - æ³¨æ„ï¼šè¿™å¯èƒ½ä¼šå¢åŠ èµ„æºæ¶ˆè€—

2. **ä½¿ç”¨Rediså­˜å‚¨ä»»åŠ¡çŠ¶æ€**
   - å½“å‰ä½¿ç”¨å†…å­˜Mapå­˜å‚¨ï¼Œé‡å¯ä¼šä¸¢å¤±
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Redis

3. **å®ç°ä»»åŠ¡é˜Ÿåˆ—**
   - å¯¹äºè¶…é•¿ä»»åŠ¡ï¼Œå¯ä»¥æ”¾å…¥é˜Ÿåˆ—å¼‚æ­¥å¤„ç†
   - å‰ç«¯é€šè¿‡è½®è¯¢è·å–ç»“æœ

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜ï¼šä»£ç ç”Ÿæˆåˆ°ä¸€åŠå°±åœæ­¢äº†

**å¯èƒ½åŸå› ï¼š**
1. CloudBaseè¶…æ—¶æ—¶é—´è®¾ç½®è¿‡çŸ­ï¼ˆé»˜è®¤å¯èƒ½æ˜¯30ç§’ï¼‰
2. ç½‘ç»œè¿æ¥ä¸ç¨³å®š
3. AI APIå“åº”è¶…æ—¶

**è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… æ£€æŸ¥CloudBaseè¶…æ—¶è®¾ç½®æ˜¯å¦ä¸º300ç§’
2. âœ… æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. âœ… æŸ¥çœ‹CloudBaseæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
4. âœ… ç¡®è®¤AI APIå¯†é’¥æœ‰æ•ˆä¸”æœ‰ä½™é¢

### é—®é¢˜ï¼šç®€å•ä»£ç ä¹Ÿåˆ‡æ¢åˆ°å¼‚æ­¥æ¨¡å¼

**å¯èƒ½åŸå› ï¼š**
1. ç½‘ç»œå»¶è¿Ÿå¯¼è‡´30ç§’å†…æ²¡æœ‰æ”¶åˆ°æ•°æ®
2. AI APIå“åº”æ…¢

**è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… æ£€æŸ¥ç½‘ç»œè¿æ¥
2. âœ… æŸ¥çœ‹AI APIçŠ¶æ€
3. âœ… æ£€æŸ¥å¿ƒè·³æ˜¯å¦æ­£å¸¸å‘é€

## ğŸ“ æ€»ç»“

**å½“å‰éƒ¨ç½²ä¸Šçº¿çš„ä»£ç ç”Ÿæˆæ—¶é—´é™åˆ¶ï¼š**

| æ¨¡å¼ | æ—¶é—´é™åˆ¶ | è¯´æ˜ |
|------|---------|------|
| **æµå¼ç”Ÿæˆ** | 30ç§’-5åˆ†é’Ÿ | ç®€å•ä»»åŠ¡æµå¼æ˜¾ç¤ºï¼Œå¤æ‚ä»»åŠ¡è‡ªåŠ¨åˆ‡æ¢ |
| **å¼‚æ­¥ç”Ÿæˆ** | æœ€å¤š5åˆ†é’Ÿ | å—CloudBaseè¶…æ—¶é™åˆ¶ï¼ˆ300ç§’ï¼‰ |
| **å®é™…å¯ç”¨** | å–å†³äºä»»åŠ¡å¤æ‚åº¦ | ç®€å•ä»»åŠ¡30ç§’å†…ï¼Œå¤æ‚ä»»åŠ¡æœ€å¤š5åˆ†é’Ÿ |

**å…³é”®é…ç½®ï¼š**
- âœ… CloudBaseè¶…æ—¶ï¼š**300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰**
- âœ… æµå¼è¶…æ—¶æ£€æµ‹ï¼š**30ç§’æ— å“åº”è‡ªåŠ¨åˆ‡æ¢**
- âœ… å¿ƒè·³é—´éš”ï¼š**æ¯10ç§’**

**å»ºè®®ï¼š**
- å¦‚æœç»å¸¸éœ€è¦ç”Ÿæˆè¶…é•¿ä»£ç ï¼ˆ>5åˆ†é’Ÿï¼‰ï¼Œè€ƒè™‘ï¼š
  1. å¢åŠ CloudBaseè¶…æ—¶åˆ°600ç§’
  2. å®ç°ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿ
  3. ä½¿ç”¨Rediså­˜å‚¨ä»»åŠ¡çŠ¶æ€







